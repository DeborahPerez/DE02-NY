CREATE EXTERNAL TABLE CDW_SAPP_HIVEDB.CREDITCARD (TRANSACTION_ID INT, CUST_CC_NO STRING, TIMEID STRING, CUST_SSN INT, BRANCH_CODE INT, TRANSACTION_TYPE STRING, TRANSACTION_VALUE DOUBLE) COMMENT 'Credit Card Transactions' ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' LOCATION '/Credit_Card_System/CDW_SAPP_CREDITCARD/';     

SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;

CREATE TABLE IF NOT EXISTS CDW_SAPP_HIVEDB.EXTERNALCREDITCARD (TRANSACTION_ID INT, CUST_CC_NO STRING, TIMEID STRING, CUST_SSN INT, BRANCH_CODE INT, TRANSACTION_VALUE DOUBLE) PARTITIONED BY (TRANSACTION_TYPE STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' LOCATION '/Credit_Card_System/CDW_SAPP_EXTERNALCREDITCARD/';  

INSERT OVERWRITE TABLE CDW_SAPP_HIVEDB.EXTERNALCREDITCARD PARTITION (TRANSACTION_TYPE) SELECT TRANSACTION_ID, CUST_CC_NO, TIMEID, CUST_SSN, BRANCH_CODE, TRANSACTION_VALUE, TRANSACTION_TYPE FROM CDW_SAPP_HIVEDB.CREDITCARD;