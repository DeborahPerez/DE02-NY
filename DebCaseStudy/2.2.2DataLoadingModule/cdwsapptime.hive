CREATE EXTERNAL TABLE IF NOT EXISTS CDW_SAPP_HIVEDB.TIME (TIMEID DATE, DAY INT, MONTH INT, QUARTER STRING, YEAR INT) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'LOCATION '/Credit_Card_System/CDW_SAPP_TIME/';

SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;                                                                                                                
 
CREATE EXTERNAL TABLE IF NOT EXISTS CDW_SAPP_HIVEDB.EXTERNALTIME (TIMEID DATE, DAY INT, MONTH INT, QUARTER STRING) PARTITIONED BY (YEAR INT) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'LOCATION '/Credit_Card_System/CDW_SAPP_EXTERNALTIME/';

INSERT OVERWRITE TABLE CDW_SAPP_HIVEDB.EXTERNALTIME PARTITION (YEAR) SELECT TIMEID, DAY, MONTH, QUARTER, YEAR FROM CDW_SAPP_HIVEDB.TIME;