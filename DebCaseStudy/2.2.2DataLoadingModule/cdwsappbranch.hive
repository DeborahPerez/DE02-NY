create external table if not exists CDW_SAPP_HIVEDB.BRANCH (BRANCH_CODE INT, BRANCH_NAME STRING, BRANCH_STREET STRING, BRANCH_CITY STRING, BRANCH_STATE STRING, BRANCH_ZIP INT, BRANCH_PHONE STRING, LAST_UPDATED TIMESTAMP) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' LOCATION '/Credit_Card_System/CDW_SAPP_BRANCH';  

SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;

CREATE TABLE IF NOT EXISTS CDW_SAPP_HIVEDB.EXTERNALBRANCH (BRANCH_CODE INT, BRANCH_NAME STRING, BRANCH_STREET STRING, BRANCH_CITY STRING, BRANCH_ZIP INT, BRANCH_PHONE STRING, LAST_UPDATED TIMESTAMP) PARTITIONED BY (BRANCH_STATE STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' LOCATION '/Credit_Card_System/CDW_SAPP_EXTERNALBRANCH'; 

INSERT OVERWRITE TABLE CDW_SAPP_HIVEDB.EXTERNALBRANCH PARTITION (BRANCH_STATE) SELECT BRANCH_CODE, BRANCH_NAME, BRANCH_STREET, BRANCH_CITY, BRANCH_ZIP, BRANCH_PHONE, LAST_UPDATED, BRANCH_STATE FROM CDW_SAPP_HIVEDB.BRANCH; 